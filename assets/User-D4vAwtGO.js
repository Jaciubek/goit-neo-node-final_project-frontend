import{j as e,Y as O,k as h,x as H,z as le,a0 as pe,N as J,M as E,$ as X,a1 as de,A as fe,u as Q,W as Z,B as z,F as K,r as f,a2 as ue,a3 as _e,a4 as me,a5 as he,a6 as ge,a7 as we,L as xe,a8 as je,a9 as ve,w as G,v as Ce,aa as ye,ab as be,ac as Ne,ad as Le,ae as Pe,af as A,ag as Fe,_ as U,C as Ie,ah as Re}from"./index-yoXa5b76.js";import{s as ee,a as q,b as Ue,c as We,d as Se}from"./profileSelectors-DjL7l0TR.js";import{r as Te}from"./recipe_without_img-BDzgIXng.js";import{S as ke}from"./SectionTitle-DS2sjKk0.js";import{B as Ee}from"./BreadCrumbs-DwSYfv-d.js";const Oe="_container_1pwje_1",qe="_content_1pwje_6",De="_message_1pwje_10",C={container:Oe,content:qe,message:De},Ae="_menuContainer_1kjmf_1",Be="_menuItem_1kjmf_15",Me="_active_1kjmf_38",B={menuContainer:Ae,menuItem:Be,active:Me},$e=({menuItems:s,activeTab:a,setActiveTab:t})=>e.jsx("div",{className:B.menuContainer,children:s.map(i=>e.jsx("div",{className:`${B.menuItem} ${i.id===a?B.active:""}`,onClick:()=>t(i.id),children:i.label},i.id))}),ze="_recipeCard_cpas5_1",Ve="_recipeImg_cpas5_9",Y={recipeCard:ze,recipeImg:Ve},se=({imgUrl:s,title:a})=>e.jsx("div",{className:Y.recipeCard,children:e.jsx("img",{className:Y.recipeImg,src:s!=="[object FileList]"?s:Te,alt:a})}),Qe="_recipeCardWrapper_1cu55_1",Ge="_flexPhotoWrapper_1cu55_6",Ye="_recipeTextWrapper_1cu55_11",He="_recipeInstructions_1cu55_15",Je="_recipeTitle_1cu55_26",Xe="_buttonWrapper_1cu55_32",Ze="_recipeCardList_1cu55_37",Ke="_iconBtn_1cu55_43",es="_icon_1cu55_43",x={recipeCardWrapper:Qe,flexPhotoWrapper:Ge,recipeTextWrapper:Ye,recipeInstructions:He,recipeTitle:Je,buttonWrapper:Xe,recipeCardList:Ze,iconBtn:Ke,icon:es},ss=({data:s,tab:a})=>{const t=O(),i=h(H),l=h(ee),p=h(q),[c]=le(),[d]=pe(),u=()=>{a==="recipe"?(t(X(l.filter(_=>_._id!==s._id))),d(s._id)):(t(de(i.filter(_=>_!==s._id))),fe(c,s._id,"delete"))};return e.jsxs("li",{className:x.recipeCardWrapper,children:[e.jsxs("div",{className:x.flexPhotoWrapper,children:[e.jsx(se,{imgUrl:s.thumb,title:s.title}),e.jsxs("div",{className:x.recipeTextWrapper,children:[e.jsxs("h5",{className:x.recipeTitle,children:[" ",s.title," "]}),e.jsx("p",{className:x.recipeInstructions,children:s.instructions})]})]}),e.jsxs("div",{className:x.buttonWrapper,children:[e.jsx(J,{to:`/recipe/${s._id}`,children:e.jsx(E,{iconId:"icon-arrow-up-right",style:x.iconBtn,styleSVG:x.icon})}),p&&e.jsx(E,{iconId:"icon-trash",onClick:u,style:x.iconBtn,styleSVG:x.icon})]})]})},M=({data:s,tab:a})=>e.jsx("ul",{className:x.recipeCardList,children:s.map(t=>e.jsx(ss,{data:t,tab:a},t._id))}),ts="_cardWrapper_9gq3s_1",rs="_photoWrapper_9gq3s_8",os="_smallProfilePhoto_9gq3s_21",as="_followerData_9gq3s_27",is="_name_9gq3s_33",ns="_descr_9gq3s_41",cs="_followerCardList_9gq3s_48",ls="_iconBtn_9gq3s_52",ps="_icon_9gq3s_52",ds="_recipesList_9gq3s_86",fs="_recipeCard_9gq3s_93",us="_link_wrapper_9gq3s_110",j={cardWrapper:ts,photoWrapper:rs,smallProfilePhoto:os,followerData:as,name:is,descr:ns,followerCardList:cs,iconBtn:ls,icon:ps,recipesList:ds,recipeCard:fs,link_wrapper:us},_s=({data:s,tab:a,handleFollowUser:t,handleUnfollowUser:i})=>{var u;const l=Q(768,!1,3),p=Q(1440,3,4),c=h(Z),d=()=>{if(a==="followers")return s.isFollowing?"unfollow":"follow";if(a==="following")return"unfollow"};return e.jsxs("li",{className:j.cardWrapper,children:[e.jsxs("div",{className:j.followerData,children:[e.jsx("img",{src:s.avatarURL||"https://gravatar.com/avatar/000000000000000000000000000000000000000000000000000000?d=mp",className:j.smallProfilePhoto,alt:"User avatar"}),e.jsxs("div",{children:[e.jsxs("h5",{className:j.name,children:[" ",s.name.split(" ")[0]]}),e.jsxs("p",{className:j.descr,children:["Own recipes: ",s.totalRecipes]}),e.jsx(z,{disabled:s._id===c,text:d(),variant:"follow_user",onClick:()=>d()==="follow"?t(s._id):i(s._id)})]})]}),l&&e.jsx("ul",{className:j.recipesList,children:(u=s==null?void 0:s.recipes)==null?void 0:u.map((_,o)=>{if(o<p)return e.jsx("li",{children:e.jsx(se,{imgUrl:_.thumb,title:_.title})},_._id)})}),e.jsx(J,{to:`/user/${s._id}`,className:j.link_wrapper,children:e.jsx(E,{iconId:"icon-arrow-up-right",style:j.iconBtn,styleSVG:j.icon})})]})},$=({data:s,tab:a,handleFollowUser:t,handleUnfollowUser:i})=>e.jsx("ul",{className:j.followerCardList,children:s.map(l=>e.jsx(_s,{data:l,tab:a,handleFollowUser:t,handleUnfollowUser:i},l._id))}),N=[{id:"my-recipes",label:"MY RECIPES",message:"Nothing has been added to your recipes list yet. Please browse our recipes and add your favorites for easy access in the future."},{id:"my-favorites",label:"MY FAVORITES",message:"Nothing has been added to your favorite recipes list yet. Please browse our recipes and add your favorites for easy access in the future."},{id:"followers",label:"FOLLOWERS",message:"There are currently no followers on your account. Please engage our visitors with interesting content and draw their attention to your profile."},{id:"following",label:"FOLLOWING",message:"Your account currently has no subscriptions to other users. Learn more about our users and select those whose content interests you."}],W=[{id:"recipes",label:"RECIPES",message:"The current user hasn't added any recipes yet."},{id:"followers",label:"FOLLOWERS",message:"The current user hasn't any followers yet."}],ms=({handleFollowUser:s,handleUnfollowUser:a})=>{const{id:t}=K(),i=O(),l=h(q),p=h(Ue),c=h(We),d=f.useRef(null),u=h(ee),_=h(H),[o,y]=f.useState(1),[L,n]=f.useState(0),[r,m]=f.useState(l?N[0].id:W[0].id),{data:g,isLoading:w}=ue({userId:t,page:o},{skip:r!=="my-recipes"&&r!=="recipes",refetchOnMountOrArgChange:!0});f.useEffect(()=>{y(1)},[r]);const R=({selected:F})=>{y(F+1),d.current&&d.current.scrollIntoView({behavior:"smooth"})};f.useEffect(()=>{m(l?N[0].id:W[0].id)},[l]);const{data:b,isLoading:te}=_e({page:o,limit:10,skip:r!=="my-favorites"}),{data:T,isLoading:re}=me({userId:t,page:o,skip:r!=="followers"}),{data:k,isLoading:oe}=he({skip:r!=="following",page:o}),ae=w||te||re||oe;f.useEffect(()=>{(r==="my-recipes"||r==="recipes")&&g&&!w&&(n(g.totalPages),i(X(g.data))),r==="followers"&&T?(n(T.totalPages),i(ge(T.followersWithRecipes))):r==="following"&&k?(n(k.totalPages),i(we(k.followingWithRecipes))):r==="my-favorites"&&b&&n(b.totalPages)},[r,i,T,k,b,w,g,o,_]);const P=(F,D)=>F.find(({id:ce})=>ce===D).message,ie=()=>{var F;if(l)switch(r){case"my-recipes":return(u==null?void 0:u.length)>0?e.jsx(M,{data:u,tab:"recipe"}):e.jsx("p",{className:C.message,children:P(N,r)});case"my-favorites":if(((F=b.data)==null?void 0:F.length)>0){const D=b==null?void 0:b.data.map(V=>V.recipe);return e.jsx(M,{data:D,tab:"favorites"})}else return e.jsx("p",{className:C.message,children:P(N,r)});case"followers":return(p==null?void 0:p.length)>0?e.jsx($,{handleFollowUser:s,handleUnfollowUser:a,data:p,tab:"followers"}):e.jsx("p",{className:C.message,children:P(N,r)});case"following":return(c==null?void 0:c.length)>0?e.jsx($,{handleFollowUser:s,handleUnfollowUser:a,data:c,tab:"following"}):e.jsx("p",{className:C.message,children:P(N,r)});default:return null}else switch(r){case"recipes":return(g==null?void 0:g.total)>0?e.jsx(M,{data:g.data}):e.jsx("p",{className:C.message,children:P(W,r)});case"followers":return(p==null?void 0:p.length)>0?e.jsx($,{handleFollowUser:s,handleUnfollowUser:a,data:p,tab:"followers"}):e.jsx("p",{className:C.message,children:P(W,r)});default:return null}},ne=l?N:W;return e.jsxs("div",{className:C.container,ref:d,children:[e.jsx($e,{menuItems:ne,activeTab:r,setActiveTab:m}),ae?e.jsx(xe,{}):e.jsx("div",{className:C.content,children:ie()}),L>1&&e.jsx(je,{pageCount:L,onPageChange:R,currentPage:o})]})},hs="_profileContainer_6wd4a_1",gs="_navPath_6wd4a_6",ws="_profileTitle_6wd4a_10",xs="_profileDescription_6wd4a_14",js="_userDetailsWrapper_6wd4a_24",vs="_profileContentLayout_6wd4a_67",I={profileContainer:hs,navPath:gs,profileTitle:ws,profileDescription:xs,userDetailsWrapper:js,profileContentLayout:vs},Cs="_profile_card_wrapper_td0jq_1",ys="_profile_card_td0jq_1",bs="_profile_name_td0jq_22",Ns="_profile_card_info_td0jq_31",Ls="_profile_info_item_td0jq_38",Ps="_profile_info_content_td0jq_48",Fs="_profile_big_card_button_td0jq_56",Is="_profile_big_card_icon_td0jq_65",Rs="_profile_photo_td0jq_69",v={profile_card_wrapper:Cs,profile_card:ys,profile_name:bs,profile_card_info:Ns,profile_info_item:Ls,profile_info_content:Ps,profile_big_card_button:Fs,profile_big_card_icon:Is,profile_photo:Rs},Us=s=>s.charAt(0).toUpperCase()+s.slice(1),Ws=({name:s,value:a})=>{const t={email:"email",createdRecipesCount:"added recipes",favoriteRecipesCount:"favorites",followersCount:"followers",followingCount:"following"};return e.jsxs("li",{className:v.profile_info_item,children:[Us(t[s]),":",e.jsx("span",{className:v.profile_info_content,children:a})]})},Ss=()=>{const s=h(q),[a]=ve(),t=h(Se),i=O(),l=t?Object.keys(t):[],[p,c]=f.useState((t==null?void 0:t.avatar)||G),d=async n=>{const r=new FormData;r.append("avatar",n);try{const m=await a(r).unwrap();c(m.avatarURL),i(ye(m.avatarURL))}catch(m){console.error("Error updating avatar:",m)}},u=n=>{const r=n.target.files[0];if(r){const m=new FileReader;m.onload=()=>{d(r)},m.readAsDataURL(r)}},_=f.useRef(null),[o,y]=f.useState({width:16,height:16}),L=()=>{_.current.click()};return f.useEffect(()=>{c((t==null?void 0:t.avatar)||G)},[t==null?void 0:t.avatar]),f.useEffect(()=>{const n=()=>{window.matchMedia("(max-width: 768px)").matches?y({width:16,height:16}):y({width:18,height:18})};return n(),window.addEventListener("resize",n),()=>{window.removeEventListener("resize",n)}},[]),e.jsx("div",{className:v.profile_card_wrapper,children:e.jsxs("div",{className:v.profile_card,children:[e.jsx("img",{className:v.profile_photo,src:p,alt:`${(t==null?void 0:t.name)||"User Name"} avatar`}),s&&e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"file",ref:_,style:{display:"none"},onChange:u}),e.jsx(E,{iconId:"icon-plus",style:v.profile_big_card_button,styleSVG:v.profile_big_card_icon,stroke:"#FFF",width:o.width,height:o.height,onClick:L})]}),e.jsx("h3",{className:v.profile_name,children:t==null?void 0:t.name}),e.jsx("ul",{className:v.profile_info,children:l.map(n=>{if(!(n==="_id"||n==="name"||n==="avatar"))return e.jsx(Ws,{name:n,value:t[n]},Ce())})})]})})},S="toastId",Ds=()=>{const s=h(Z),[a,t]=f.useState(!1),[i,l]=f.useState(!1),p=h(q),{id:c}=K(),d=O(),{data:u,error:_}=be(c),{data:o}=Ne(),[y,{error:L}]=Le(),[n,{error:r}]=Pe(),m=w=>{if(y(w),L){U.error("Something went wrong",{toastId:S});return}d(A({...o,following:[...o.following,w]})),U.success("Follow successful",{toastId:S})},g=w=>{if(n(w),r){U.error("Something went wrong",{toastId:S});return}d(A({...o,following:o.following.filter(R=>R!==w)})),U.success("Unfollow successful",{toastId:S})};if(f.useEffect(()=>{if(c!==s&&o&&o.following){const w=o.following.some(R=>R===c);l(w)}},[o,c,s]),f.useEffect(()=>{o&&d(A(o)),u&&d(Fe(u))},[u,o,d]),_){U.error(_.data.message,{toastId:S});return}return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:I.profileContainer,children:[e.jsx("div",{className:I.navPath,children:e.jsx(Ee,{currentPage:"Profile"})}),e.jsx("div",{className:I.profileTitle,children:e.jsx(ke,{text:"Profile"})}),e.jsxs("p",{className:I.profileDescription,children:["Reveal your culinary art, share your favorite recipe and create ",e.jsx("br",{}),"gastronomic masterpieces with us."]}),e.jsxs("div",{className:I.profileContentLayout,children:[e.jsxs("div",{className:I.userDetailsWrapper,children:[e.jsx(Ss,{}),p?e.jsx(z,{type:"button",variant:"logoutOrFollowBtn",text:"Log Out",onClick:()=>t(!0)}):e.jsx(z,{type:"button",variant:"logoutOrFollowBtn",text:i?"Unfollow":"Follow",onClick:i?()=>g(c):()=>m(c)})]}),e.jsx(ms,{handleFollowUser:m,handleUnfollowUser:g})]})]}),e.jsx(Ie,{isOpen:a,onClose:()=>t(!1),children:e.jsx(Re,{setModalLogOutOpen:t})})]})};export{Ds as default};
