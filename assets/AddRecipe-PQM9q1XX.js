import{H as ee,J as C,r as g,j as e,K as L,I as te,M as w,P as E,B as H,L as se,Q as ae,T as ne,U as re,V as ie,k as Q,W as oe,X as ce,Y as le,l as de,Z as pe,_ as W,$ as me}from"./index-yoXa5b76.js";import{B as _e}from"./BreadCrumbs-DwSYfv-d.js";import{S as ue}from"./SectionTitle-DS2sjKk0.js";import{s as he}from"./profileSelectors-DjL7l0TR.js";const xe=ee().shape({title:C().required("Title is required"),description:C().max(200,"Description must be at most 200 characters").required("Description is required"),category:C().required("Category is required"),area:C().required("Area is required"),instructions:C().max(2e3,"Description must be at most 200 characters").required("Instructions are required")}),ge="_recipeContainer_eafas_1",fe="_sectionHeader_eafas_9",je="_navCrumbs_eafas_16",be="_titleSection_eafas_20",ye="_titleAndNavWrapper_eafas_24",Ne="_formContainer_eafas_31",Ie="_formLayout_eafas_37",ve="_formLabel_eafas_42",Ce="_recipeNameInput_eafas_53",Se="_recipeNameInputWrapper_eafas_67",Ae="_errorMessageTitle_eafas_71",Be="_errorMessage_eafas_71",Te="_textAreaContainer_eafas_99",We="_recipeTextArea_eafas_103",$e="_labelPreparation_eafas_122",Le="_wordCounter_eafas_133",we="_recipeDetails_eafas_140",Me="_recipeSteps_eafas_146",De="_actionButtons_eafas_150",Re="_submitButton_eafas_157",ke="_deleteButton_eafas_167",qe="_deleteIcon_eafas_175",Ue="_categoryAndTimeSection_eafas_211",t={recipeContainer:ge,sectionHeader:fe,navCrumbs:je,titleSection:be,titleAndNavWrapper:ye,formContainer:Ne,formLayout:Ie,formLabel:ve,recipeNameInput:Ce,recipeNameInputWrapper:Se,errorMessageTitle:Ae,errorMessage:Be,textAreaContainer:Te,recipeTextArea:We,labelPreparation:$e,wordCounter:Le,recipeDetails:we,recipeSteps:Me,actionButtons:De,submitButton:Re,deleteButton:ke,deleteIcon:qe,categoryAndTimeSection:Ue},Ee="_errorMsg_1sccx_5",Qe="_wrapper_1sccx_11",Pe="_uploadBox_1sccx_20",He="_uploadAnotherSpan_1sccx_32",Fe="_customUploadBtn_1sccx_43",Ge="_imagePreview_1sccx_55",Je="_btnWrapper_1sccx_65",Oe="_photoIcon_1sccx_102",x={errorMsg:Ee,wrapper:Qe,uploadBox:Pe,uploadAnotherSpan:He,customUploadBtn:Fe,imagePreview:Ge,btnWrapper:Je,photoIcon:Oe},ze=({register:n,setValue:a,imagePreview:c,setImagePreview:d,errors:i,watch:l})=>(g.useEffect(()=>{const o=l(f=>{f.thumb[0]&&(d(URL.createObjectURL(f.thumb[0])),a("thumb",f.thumb[0]))});return()=>o.unsubscribe()},[l,d,a]),e.jsxs("div",{className:x.wrapper,children:[e.jsx("div",{className:x.uploadBox,children:e.jsxs("label",{className:x.customUploadBtn,children:[e.jsx(L,{type:"file",name:"thumb",register:n,setValue:a,errors:i}),c&&e.jsx("img",{src:c,alt:"Recipe Preview",className:x.imagePreview}),e.jsxs("div",{className:x.btnWrapper,children:[!c&&e.jsxs(e.Fragment,{children:[e.jsx(te,{iconId:"icon-capture-photo-camera",width:"50px",height:"50",customStyle:x.photoIcon}),e.jsx("span",{children:"Upload a photo"})]}),i.thumb&&e.jsx("p",{className:x.errorMsg,children:i.thumb.message})]})]})}),c&&e.jsxs("label",{className:x.uploadAnotherSpan,children:[e.jsx(L,{type:"file",name:"thumb",register:n,setValue:a,errors:i}),"Upload another photo"]})]})),Ke="_container_192la_1",Ve="_errorMsg_192la_7",Xe="_selectors_time_wrapp_192la_13",Ye="_textareaWrapper_192la_19",Ze="_symbolCounter_192la_23",et="_textarea_192la_19",tt="_inputQuantity_192la_55",st="_buttonAdd_192la_79",at="_addBtnIcon_192la_97",nt="_icon_192la_110",rt="_list_192la_122",it="_listItem_192la_128",ot="_imageWrapper_192la_135",ct="_image_192la_135",lt="_iconBtn_192la_143",dt="_textWrapper_192la_159",pt="_ingredientAndQuantity_192la_164",s={container:Ke,errorMsg:Ve,selectors_time_wrapp:Xe,textareaWrapper:Ye,symbolCounter:Ze,textarea:et,inputQuantity:tt,buttonAdd:st,addBtnIcon:at,icon:nt,list:rt,listItem:it,imageWrapper:ot,image:ct,iconBtn:lt,textWrapper:dt,ingredientAndQuantity:pt},mt="_iconBtn_1gk00_1",_t="_icon_1gk00_1",ut="_counterInput_1gk00_21",$={iconBtn:mt,icon:_t,counterInput:ut},ht=({cookingTime:n,setCookingTime:a})=>{const c=()=>{a(i=>i+10)},d=()=>{a(i=>i>10?i-10:10)};return e.jsxs("div",{children:[e.jsx("label",{children:"Cooking Time"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[e.jsx(w,{iconId:"icon-minus",width:"16",height:"16",type:"button",style:$.iconBtn,styleSVG:$.icon,onClick:d}),e.jsx("div",{children:e.jsxs("span",{style:{margin:"0 12px"},children:[n," min"]})}),e.jsx(w,{iconId:"icon-plus",type:"button",width:"16",height:"16",style:$.iconBtn,styleSVG:$.icon,onClick:c})]})]})},xt="_form__group_1d152_1",gt="_form__field_1d152_8",ft="_form__label_1d152_28",m={form__group:xt,form__field:gt,form__label:ft},F=n=>{g.useEffect(()=>{const a=document.querySelector(`.${n}`),c=d=>{a.style.height="36px",a.style.height=`${d.target.scrollHeight}px`};return a.addEventListener("input",c),()=>{a.removeEventListener("input",c)}},[n])},jt=({register:n,setValue:a,watch:c,ingredients:d,selectedIngredients:i,setSelectedIngredients:l,errors:o,categories:f,areas:S,cookingTime:j,setCookingTime:M,isIngredientsLoading:y,isCategoriesLoading:D,isAreasLoading:R})=>{var I;const[k,A]=g.useState(!1),b=c("ingredient"),B=c("measure"),q=()=>{if(b&&B){const r=d.find(h=>h._id===b.value);l([...i,{id:b.value,measure:B,imageUrl:r.img,label:b.label}]),a("ingredient",null),a("measure",""),A(!0)}},U=r=>{l(i.filter((h,T)=>T!==r)),i.length<=1&&A(!1)},N=r=>r?e.jsx(se,{}):null;return F(s.textarea),e.jsxs("div",{className:s.container,children:[e.jsxs("div",{className:`${m.form__group} ${m.field}`,children:[e.jsx("textarea",{...n("description"),name:"description",maxLength:"200",placeholder:"Enter the description of the dish",id:"description",className:`${m.form__field} ${s.textarea}`,required:!0}),e.jsx("label",{htmlFor:"description",className:m.form__label,children:"Enter the description of the dish"}),e.jsxs("span",{className:s.symbolCounter,children:[((I=c("description"))==null?void 0:I.length)||0,"/200"]})]}),o.description&&e.jsx("p",{className:s.errorMsg,children:o.description.message}),e.jsxs("div",{className:s.selectors_time_wrapp,children:[e.jsx("div",{className:s.categoryAndTime,children:N(D)||e.jsxs("div",{children:[e.jsx("label",{children:"Category"}),e.jsx(E,{options:f,placeholder:"Select a category",...n("category"),onChange:r=>a("category",r.label)}),o.category&&e.jsx("p",{className:s.errorMsg,children:o.category.message})]})}),e.jsxs("div",{children:[e.jsx(ht,{cookingTime:j,setCookingTime:M}),o.cookingTime&&e.jsx("p",{className:s.errorMsg,children:o.cookingTime.message})]})]}),e.jsx("div",{className:s.categoryAndTime,children:N(R)||e.jsxs("div",{children:[e.jsx("label",{children:"Area"}),e.jsx(E,{options:S,placeholder:"Select area",...n("area"),onChange:r=>a("area",r.label)}),o.area&&e.jsx("p",{className:s.errorMsg,children:o.area.message})]})}),e.jsxs("div",{className:s.ingredientAndQuantity,children:[y?e.jsx("p",{children:"Loading..."}):e.jsxs("div",{children:[e.jsx("label",{children:"Ingredient"}),e.jsx(E,{options:d,placeholder:"Select an ingredient",className:s.select,...n("ingredient"),onChange:r=>a("ingredient",r)}),o.ingredient&&e.jsx("p",{className:s.errorMsg,children:o.ingredient.message})]}),e.jsxs("div",{className:`${m.form__group} ${m.field}`,children:[e.jsx(L,{type:"text",name:"measure",id:"measure",register:n,placeholder:"Enter quantity",classname:`${s.inputQuantity} ${m.form__field}`}),e.jsx("label",{className:m.form__label,htmlFor:"measure",children:"Enter quantity"}),o.measure&&e.jsx("p",{className:s.errorMsg,children:o.measure.message})]})]}),k&&e.jsx("ul",{className:s.list,children:i.map((r,h)=>e.jsxs("li",{className:s.listItem,children:[e.jsx("div",{className:s.imageWrapper,children:e.jsx("img",{src:r.imageUrl,alt:r.label,width:"55px",height:"55px",className:s.image})}),e.jsxs("div",{className:s.textWrapper,children:[e.jsx("p",{children:r.label}),e.jsx("p",{children:r.measure})]}),e.jsx(w,{iconId:"icon-close-btn",type:"button",onClick:()=>U(h),style:s.iconBtn})]},h))}),e.jsx(H,{text:"Add ingredient",type:"button",onClick:q,iconId:"icon-plus",iconStyle:s.addBtnIcon,classname:s.buttonAdd})]})},bt="_formTitleWrapper_17dnn_1",yt="_fromDescription_17dnn_19",Nt="_formTitle_17dnn_1",P={formTitleWrapper:bt,fromDescription:yt,formTitle:Nt},It=()=>e.jsx("div",{className:P.formTitleWrapper,children:e.jsx("p",{className:P.fromDescription,children:"Reveal your culinary art, share your favorite recipe and create gastronomic masterpieces with us."})}),Bt=()=>{const{register:n,handleSubmit:a,control:c,setValue:d,watch:i,formState:{errors:l},reset:o}=ae({resolver:pe(xe),defaultValues:{selectedIngredients:[]}}),[f,S]=g.useState(0),j=200,M=u=>{const v=u.target.value.trim().split(/\s+/).filter(p=>p.length>0);if(v.length<=j)S(v.length);else{const p=v.slice(0,j).join(" ");u.target.value=p,S(j),W.error(`max length ${j} words`)}},y="addRecipeToastId",{data:D,isLoading:R}=ne(),{data:k,isLoading:A}=re(),{data:b,isLoading:B}=ie(),[q]=g.useState(Q(oe)),[U]=ce(),[N,I]=g.useState([]),[r,h]=g.useState(null),[T,G]=g.useState(10),J=Q(he),O=le(),z=D,K=k,V=b,X=de(),Y=async u=>{const _=new FormData;_.append("thumb",u.thumb),_.append("title",u.title),_.append("description",u.description),_.append("category",u.category),_.append("area",u.area),_.append("time",T.toString()),_.append("instructions",u.instructions);const v=N.map(p=>({id:p.id,measure:p.measure}));_.append("ingredients",JSON.stringify(v));try{const p=await U(_);p.error?W.error(p.error.data.message,{toastId:y}):(O(me([...J,p.data.data])),X(`/user/${q}`),W.success("Recipe added",{toastId:y}),o())}catch(p){W.error(p.message,{toastId:y})}},Z=()=>{o(),h(null),I([])};return F(t.recipeTextArea),e.jsxs("div",{className:t.recipeContainer,children:[e.jsxs("div",{className:t.titleAndNavWrapper,children:[e.jsx("div",{className:t.navCrumbs,children:e.jsx(_e,{currentPage:"Add Recipe"})}),e.jsxs("div",{className:t.titleSection,children:[e.jsx(ue,{text:"add recipe"}),e.jsx(It,{})]})]}),e.jsx("form",{onSubmit:a(Y),className:t.formLayout,children:e.jsxs("div",{className:t.formContainer,children:[e.jsx(ze,{register:n,setValue:d,imagePreview:r,setImagePreview:h,watch:i,errors:l}),e.jsxs("div",{children:[e.jsxs("div",{className:t.recipeNameInputWrapper,children:[e.jsx(L,{type:"text",name:"title",register:n,placeholder:"The name of the recipe",classname:t.recipeNameInput}),l.title&&e.jsx("p",{className:t.errorMessageTitle,children:l.title.message})]}),e.jsx("div",{className:t.recipeDetails,children:e.jsx("div",{className:t.categoryAndTimeSection,children:e.jsxs("div",{className:t.recipeDetails,children:[e.jsx(jt,{control:c,register:n,setValue:d,watch:i,categories:z,areas:V,cookingTime:T,setCookingTime:G,ingredients:K,selectedIngredients:N,setSelectedIngredients:I,errors:l,isCategoriesLoading:R,isIngredientsLoading:A,isAreasLoading:B}),l.selectedIngredients&&e.jsx("p",{className:t.errorMessage,children:l.selectedIngredients.message})]})})}),e.jsxs("div",{className:t.recipeSteps,children:[e.jsx("h2",{className:t.sectionHeader,children:"Recipe preparation"}),e.jsxs("div",{className:`${t.textAreaContainer} ${m.form__group} ${m.field}`,children:[e.jsx("textarea",{...n("instructions"),onInput:M,id:"instructions",name:"instructions",placeholder:"Enter recipe",maxLength:"none",className:`${t.recipeTextArea} ${m.form__field}`}),e.jsx("label",{className:`${t.labelPreparation} ${m.form__label}`,children:"Enter recipe"}),e.jsxs("span",{className:t.wordCounter,children:[f,"/",j]}),l.instructions&&e.jsx("p",{className:t.errorMessage,children:l.instructions.message})]})]}),e.jsxs("div",{className:t.actionButtons,children:[e.jsx(w,{iconId:"icon-trash",type:"button",onClick:Z,width:"20",height:"20",style:t.deleteButton,styleSVG:t.deleteIcon}),e.jsx(H,{text:"Publish",type:"submit",classname:t.submitButton})]})]})]})})]})};export{Bt as default};
